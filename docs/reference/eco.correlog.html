<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Moran's I, Geary's C and bivariate Moran's I correlograms, omnidirectional and directional — eco.correlog • EcoGenetics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EcoGenetics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cran/EcoGenetics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran's I, Geary's C and bivariate Moran's I correlograms, omnidirectional and directional</h1>
    </div>

    
    <p>This program computes Moran's, Geary's and bivariate Moran's correlograms, 
for single or multiple variables, with P-values or bootstrap confidence intervals.
Correlograms can be omnidirectional or directional, the latter based in the bearing method 
(Rosenberg, 2000).
The program allows high flexibility for the construction of intervals. For detailed
information about the range partition methods see <code><a href='eco.lagweight.html'>eco.lagweight</a></code></p>
    

    <pre class="usage"><span class='fu'>eco.correlog</span>(<span class='no'>Z</span>, <span class='no'>XY</span>, <span class='kw'>Y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>int</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>smin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>smax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>nclass</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>seqvec</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"I"</span>, <span class='st'>"C"</span>, <span class='st'>"CC"</span>),
  <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"permutation"</span>, <span class='st'>"bootstrap"</span>), <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"auto"</span>, <span class='st'>"two.sided"</span>, <span class='st'>"greater"</span>, <span class='st'>"less"</span>), <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"holm"</span>,
  <span class='kw'>sequential</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>((<span class='no'>as.deg</span>), <span class='fl'>FALSE</span>, <span class='fl'>TRUE</span>), <span class='kw'>include.zero</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>cummulative</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>bin</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sturges"</span>, <span class='st'>"FD"</span>), <span class='kw'>row.sd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>latlon</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>angle</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>as.deg</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Z</th>
      <td><p>Vector, matrix or data frame with variable/s
(in matrix or data frame formats, variables in columns).</p></td>
    </tr>
    <tr>
      <th>XY</th>
      <td><p>Data frame or matrix with individual's positions (projected coordinates).</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>Vector with the second variable for Mantel's Ixy cross-correlograms.
If Z has multiple variables, the program will compute the cross-correlograms 
for each with Y.</p></td>
    </tr>
    <tr>
      <th>int</th>
      <td><p>Distance interval in the units of XY.</p></td>
    </tr>
    <tr>
      <th>smin</th>
      <td><p>Minimum class distance in the units of XY.</p></td>
    </tr>
    <tr>
      <th>smax</th>
      <td><p>Maximum class distance in the units of XY.</p></td>
    </tr>
    <tr>
      <th>nclass</th>
      <td><p>Number of classes.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>Number of individuals per class.</p></td>
    </tr>
    <tr>
      <th>seqvec</th>
      <td><p>Vector with breaks in the units of XY.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Correlogram method. It can be I for Moran's I, C for Geary's C
and CC for Bivariate Moran's Ixy. 
If method = "CC", the program computes for the first interval (d = 0)
the corresponding P-value and CI with <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor.test'>cor.test</a></code>.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of Monte-Carlo simulations.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>If test = "bootstrap", the program generates a bootstrap 
resampling and the associated confidence intervals of the null hypothesis.
 If test = "permutation" (default) a permutation test is made and the P-values 
 are computed.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Value for alpha (significance level). Default alpha = 0.05.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>The alternative hypothesis. If "auto" is selected (default) the
program determines the alternative hypothesis.
Other options are: "two.sided", "greater" and "less".</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>P-values correction method for multiple tests. 
The selected method is passed as argument to <code><a href='http://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code> (defalut = "holm").
For bearing correlograms, the corrections (and permutation tests) are performed for individual correlograms 
of fixed variables (i.e.,  angles fixed [distances variable] or distances fixed [angles variable]).</p></td>
    </tr>
    <tr>
      <th>sequential</th>
      <td><p>Should a Holm-Bonberroni correction of P-values (Legendre and Legendre, 2012) be performed?
Defalult TRUE (only available for omnidirectional correlograms or correlograms for fixed angles).</p></td>
    </tr>
    <tr>
      <th>include.zero</th>
      <td><p>Should be included the distance = 0 in cross correlograms 
(i.e., the intra- individual correlation)?. Defalut TRUE.</p></td>
    </tr>
    <tr>
      <th>cummulative</th>
      <td><p>Should be construced a cummulative correlogram?.</p></td>
    </tr>
    <tr>
      <th>bin</th>
      <td><p>Rule for constructing intervals when a partition parameter (int, 
nclass or size) is not given. Default is Sturge's rule (Sturges, 1926). Other
option is Freedman-Diaconis method (Freedman and Diaconis, 1981).</p></td>
    </tr>
    <tr>
      <th>row.sd</th>
      <td><p>Logical. Should be row standardized the matrix? Default FALSE 
(binary weights).</p></td>
    </tr>
    <tr>
      <th>latlon</th>
      <td><p>Are the coordinates in decimal degrees format? Defalut FALSE. If TRUE,
the coordinates must be in a matrix/data frame with the longitude in the first
column and latitude in the second. The position is projected onto a plane in
meters with the function <code><a href='http://www.rdocumentation.org/packages/SoDA/topics/geoXY'>geoXY</a></code>.</p></td>
    </tr>
    <tr>
      <th>angle</th>
      <td><p>for computation of bearing correlogram (angle between 0 and 180).
Default NULL (omnidirectional).</p></td>
    </tr>
    <tr>
      <th>as.deg</th>
      <td><p>in case of bearing correlograms for multiple angles, 
generate an output for each lag in function of the angle? Default TRUE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The program returns an object of class "eco.correlog" 
with the following slots:</p>
<p>&gt; OUT analysis output</p>
<p>&gt; IN analysis input data</p>
<p>&gt; BEAKS breaks</p>
<p>&gt; CARDINAL number of elements in each class</p>
<p>&gt; NAMES variables names</p>
<p>&gt; METHOD analysis method</p>
<p>&gt; DISTMETHOD method used in the construction of breaks</p>
<p>&gt; TEST test method used (bootstrap, permutation)</p>
<p>&gt; NSIM number of simulations</p>
<p>&gt; PADJUST P-values adjust method for permutation tests</p>
<p><strong>ACCESS TO THE SLOTS</strong>
The content of the slots can be accessed 
with the corresponding accessors, using
the generic notation of EcoGenetics 
(&lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;name of the object&gt;).
See help("EcoGenetics accessors") and the Examples
section below.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Freedman D., and P. Diaconis. 1981. On the histogram as a density estimator: 
L 2 theory. Probability theory and related fields, 57: 453-476.</p>
<p>Geary R. 1954. The contiguity ratio and statistical mapping. 
The incorporated statistician, 115-146.</p>
<p>Legendre P., and L. Legendre. 2012. Numerical ecology. Third English edition.
Elsevier Science, Amsterdam, Netherlands</p>
<p>Moran P. 1950. Notes on continuous stochastic phenomena. Biometrika, 17-23.</p>
<p>Reich R., R. Czaplewski and W. Bechtold. 1994. 
Spatial cross-correlation of undisturbed, natural shortleaf pine stands 
in northern Georgia. Environmental and Ecological Statistics, 1: 201-217.</p>
<p>Rosenberg, M. 2000. The bearing correlogram: a new method 
of analyzing directional spatial autocorrelation. 
Geographical Analysis, 32: 267-278.</p>
<p>Sokal R. and N. Oden 1978. Spatial autocorrelation in biology: 
1. Methodology. Biological journal of the Linnean Society, 10: 199-228.</p>
<p>Sokal R. and N. Oden. 1978. Spatial autocorrelation in biology. 
2. Some biological implications and four applications of evolutionary and 
ecological interest. Biological Journal of the Linnean Society, 10: 229-49.</p>
<p>Sokal R. 1979. Ecological parameters inferred from spatial correlograms. 
In: G. Patil and M. Rosenzweig, editors. Contemporary Quantitative Ecology and 
elated Ecometrics. International Co-operative Publishing House: Fairland,
MD, pp. 167-96.</p> 
<p>Sturges  H. 1926. The choice of a class interval. Journal of the American 
Statistical Association, 21: 65-66.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div># NOT RUN {
data(eco.test)
require(ggplot2)


##########################
# Moran's I correlogram
##########################

## single test with phenotypic traits
moran <- eco.correlog(Z=eco[["P"]][,1], XY = eco[["XY"]], 
method = "I", smax=10, size=1000)

# interactive plot via plotly
eco.plotCorrelog(moran)

# standard plot via ggplot2
eco.plotCorrelog(moran, interactivePlot = FALSE)


#-------------------------------------------------------
## A directional approach based in bearing correlograms
#-------------------------------------------------------

moran_b <- eco.correlog(Z=eco[["P"]][,1], XY = eco[["XY"]], 
method = "I", smax = 10, size = 1000, angle  = seq(0, 175, 5))

 # use eco.plotCorrelogB for this object
eco.plotCorrelogB(moran_b)

 # plot for the first distance class, 
 use a number between 1 and the number of classes to select the corresponding class
eco.plotCorrelogB(moran_b, var = 1) 

#-----------------------------
## Multivariable correlograms
#-----------------------------

## multiple tests with phenotypic traits
moran2 <- eco.correlog(Z=eco[["P"]], XY = eco[["XY"]],
method = "I", smax=10, size=1000)

eco.plotCorrelog(moran2, var ="P2") ## single plots
eco.plotCorrelog(moran2, var ="P3") ## single plots


 ## Multivariable interactive plot with mean correlogram 
 ## and jackknifed confidence intervals.
 
 graf <- eco.plotCorrelog(moran2, meanplot = TRUE)
 
 # Only mean
 graf$mean.correlog
 
 # Mean and variables
 graf$multi.correlog
 
 # Information
 - correlogram data for individual variables
 - manhattan distance matrix
 - mean correlogram data
 - method used for analysis
 - names and numbers (column in data frame) of significant variables 
 
 
 
 graf$data
 
 
 # plot only alleles
 graf <- eco.plotCorrelog(moran2, meanplot = FALSE)
 graf
 
 # Both plots can also be constructed using ggplot2
 
 gg_graf <- eco.plotCorrelog(moran2, meanplot = TRUE, interactivePlot = FALSE)
 gg_graf[[1]]
 gg_graf[[2]]
 
 gg_graf <- eco.plotCorrelog(moran2, meanplot = FALSE, interactivePlot = FALSE)
 gg_graf


# standard ggplot2 correlograms support the use of ggplot2 syntax
require(ggplot2)
moranplot <- eco.plotCorrelog(moran2, var ="P3", interactivePlot = FALSE) 
moranplot <- moranplot + theme_bw() + theme(legend.position="none")
moranplot

moranplot2 <- gg_graf[[2]] + theme_bw() + theme(legend.position="none")
moranplot2


#-----------------------
Analyzing genetic data
#-----------------------

# single test with genotypic traits

# eco[["A"]] is a matrix with the genetic data of "eco" 
# as frequencies for each allele in each individual. Each allele
# can be analyzed as single traits. 

head(eco[["A"]])      # head of the matrix

# analyzing allele 1
moran <- eco.correlog(Z=[["A"]][,1], XY = eco[["XY"]], method = "I",
smax=10, size=1000)                
eco.plotCorrelog(moran)

# multiple tests with genotypic traits. 
# nsim is set to 10 only for speed in the example
moran2 <- eco.correlog(Z = eco[["A"]], XY = eco[["XY"]], 
method = "I",smax=10, size=1000, nsim=99)


## multiple plot with mean 
## correlogram and jackknifed 
## confidence intervals.

graf <- eco.plotCorrelog(moran2, meanplot = TRUE)

## the same example, but with nsim = 99. 
moran3 <- eco.correlog(Z = eco[["A"]], XY = eco[["XY"]], method = "I", 
smax=10, size=1000, nsim=99)  
       
## plot for alleles with at least one significant value after
## Bonferroni-Holm sequential P correction
## (set adjust "none" for no family-wise 
## P correction in "eco.correlog")

eco.plotCorrelog(moran3, meanplot = TRUE, significant.M = TRUE)

#-----------------------
# ACCESSORS USE EXAMPLE
#-----------------------

# the slots are accesed with the generic format 
# (ecoslot. + name of the slot + name of the object). 
# See help("EcoGenetics accessors")

ecoslot.OUT(moran)      # slot OUT
ecoslot.BREAKS(moran)   # slot BREAKS
                                             
#---------------------------------------------------------------------------#

##########################
# Geary's C correlogram
##########################

geary <- eco.correlog(Z = eco[["P"]][,1], XY = eco[["XY"]], method = "C",
smax=10, size=1000)
# Interactive plot
eco.plotCorrelog(geary)
# ggplot2 plot
eco.plotCorrelog(geary, interactivePlot = FALSE)

#---------------------------------------------------------------------------#

##########################
# Bivariate Moran's Ixy
##########################   

cross <- eco.correlog(Z=eco[["P"]][,1], XY = eco[["XY"]], Y = eco[["P"]][, 1],
method = "CC", int= 2, smax=15)
# Interactive plot
eco.plotCorrelog(cross)
# ggplot2 plot
eco.plotCorrelog(cross, interactivePlot = FALSE)

# }
<div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Leandro Roser <a href='mailto:learoser@gmail.com'>learoser@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Leandro Roser, Juan Vilardi, Beatriz Saidman, Laura Ferreyra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
