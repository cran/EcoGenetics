<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mantel and partial Mantel tests, with truncation option — eco.mantel • EcoGenetics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EcoGenetics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cran/EcoGenetics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mantel and partial Mantel tests, with truncation option</h1>
    </div>

    
    <p>Mantel test or Partial Mantel test for distance matrices d1 and d2, 
or partial Mantel test for d1 and d2, conditioned on the matrix dc.
 The test can be performed for truncated distances (Legendre et al. 2015) or for a particular direction
(Falsetti and Sokal, 1993) using a weights object generated with  <code><a href='eco.bearing.html'>eco.bearing</a></code>.</p>
    

    <pre class="usage"><span class='fu'>eco.mantel</span>(<span class='no'>d1</span>, <span class='no'>d2</span>, <span class='kw'>dc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>con</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>thres</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>truncMat</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"d2"</span>, <span class='st'>"d1"</span>, <span class='st'>"dc"</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"pearson"</span>, <span class='st'>"spearman"</span>,
  <span class='st'>"kendall"</span>), <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"auto"</span>, <span class='st'>"two.sided"</span>, <span class='st'>"less"</span>,
  <span class='st'>"greater"</span>), <span class='kw'>plotit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d1</th>
      <td><p>Distance matrix.</p></td>
    </tr>
    <tr>
      <th>d2</th>
      <td><p>Distance matrix.</p></td>
    </tr>
    <tr>
      <th>dc</th>
      <td><p>Distance matrix (optional).</p></td>
    </tr>
    <tr>
      <th>con</th>
      <td><p>Binary eco.weight object used for truncation, or a weights object obtained with eco.bearing.</p></td>
    </tr>
    <tr>
      <th>thres</th>
      <td><p>Threshold distance used for truncation. Distances above the threshold are
set as 4 times the threshold. If thres is null, and con is not null,
the parameter set to the maximum distance observed in d2.</p></td>
    </tr>
    <tr>
      <th>truncMat</th>
      <td><p>Matrix used for truncation (default = d2)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Correlation method used for the construction of the statistic 
("pearson", "spearman" or "kendall"). Kendall's tau computation is slow.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of Monte-Carlo simulations.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>The alternative hypothesis. If "auto" is selected (default) the
program determines the alternative hypothesis. Other options are: "two.sided", "greater" and "less".</p></td>
    </tr>
    <tr>
      <th>plotit</th>
      <td><p>Plot a histogram of the simulations?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "eco.gsa" with the following slots:</p>
<p>&gt; METHOD method used in the analysis</p>
<p>&gt; OBS observed value</p>
<p>&gt; EXP expect value</p>
<p>&gt; PVAL P-value</p>
<p>&gt; ALTER alternative hypotesis</p>
<p>&gt; NSIM number of simulations</p>
<p><strong>ACCESS TO THE SLOTS</strong>
The content of the slots can be accessed 
with the corresponding accessors, using
the generic notation of EcoGenetics 
(&lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;name of the object&gt;).
See help("EcoGenetics accessors") and the Examples
section below</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Falsetti A., and Sokal R. 1993. Genetic structure of human populations
 in the British Isles. Annals of Human Biology 20: 215-229.</p>
<p>Legendre P. 2000. Comparison of permutation methods for the partial correlation
and partial Mantel tests. Journal of Statistical Computation and Simulation,
67: 37-73.</p>
<p>Legendre P., and M. Fortin. 2010. Comparison of the Mantel test and 
alternative approaches for detecting complex multivariate relationships 
in the spatial analysis of genetic data. Molecular Ecology Resources, 
10: 831-844.</p>
<p>Mantel N. 1967. The detection of disease clustering and a generalized 
regression approach. Cancer research, 27: 209-220.</p>
<p>Smouse P. Long and R. Sokal. 1986. Multiple regression and correlation 
extensions of the Mantel test of matrix correspondence. Systematic zoology, 627-632.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>data</span>(<span class='no'>eco.test</span>)

<span class='co'>### Ordinary Mantel test ###</span>
<span class='fu'>eco.mantel</span>(<span class='kw'>d1</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]]), <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"E"</span>]]), <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>)

<span class='co'>### Partial Mantel test ###</span>
<span class='no'>pm</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.mantel</span>(<span class='kw'>d1</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]]), <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"E"</span>]]),
<span class='kw'>dc</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]]), <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>)

<span class='co'>### Truncated Mantel test ###</span>
<span class='co'># checking threshold in a correlogram:</span>
<span class='no'>corm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.cormantel.html'>eco.cormantel</a></span>(<span class='kw'>M</span> <span class='kw'>=</span> <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]]), <span class='kw'>XY</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>)
<span class='fu'><a href='eco.plotCorrelog.html'>eco.plotCorrelog</a></span>(<span class='no'>corm</span>)
<span class='co'># Correlation is around 0 when distance between points is &gt; 5</span>

<span class='co'># creating a weights object for truncation</span>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.weight.html'>eco.weight</a></span>(<span class='no'>eco</span>@<span class='kw'>XY</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"circle"</span>, <span class='kw'>d2</span><span class='kw'>=</span><span class='fl'>5</span>)
<span class='co'># compute a truncated mantel test</span>
<span class='fu'>eco.mantel</span>(<span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]]), <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]]), <span class='kw'>con</span><span class='kw'>=</span><span class='no'>con</span>)

<span class='co'>### Directional Mantel test ###</span>
<span class='co'># analyzing with a Mantel test, in a direction of 35 degrees counterclockwise from E.</span>
<span class='no'>con2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.bearing.html'>eco.bearing</a></span>(<span class='kw'>XY</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>37</span>)
<span class='fu'>eco.mantel</span>(<span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]]), <span class='fu'>dist</span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]]), <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con2</span>)

<span class='co'>#-----------------------</span>
<span class='co'># ACCESSORS USE EXAMPLE</span>
<span class='co'>#-----------------------</span>

<span class='co'># the slots are accessed with the generic format </span>
<span class='co'># (ecoslot. + name of the slot + name of the object). </span>
<span class='co'># See help("EcoGenetics accessors")</span>

<span class='fu'><a href='EcoGenetics-accessors.html'>ecoslot.OBS</a></span>(<span class='no'>pm</span>)     <span class='co'># slot OBS (observed value)</span>
<span class='fu'><a href='EcoGenetics-accessors.html'>ecoslot.PVAL</a></span>(<span class='no'>pm</span>)    <span class='co'># slot PVAL (P-value) </span>

<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Leandro Roser <a href='mailto:learoser@gmail.com'>learoser@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Leandro Roser, Juan Vilardi, Beatriz Saidman, Laura Ferreyra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
