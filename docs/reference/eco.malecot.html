<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Global and local kinship analyses — eco.malecot • EcoGenetics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EcoGenetics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cran/EcoGenetics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Global and local kinship analyses</h1>
    </div>

    
    <p>The program computes a global multilocus correlogram, or a local analysis, using a 
kinship matrix. When a kinship matrix is not given as input, the program
computes the Loiselle's Fij (Kalisz et al., 2001; Loiselle et al., 1995). 
The program can compute a bearing correlogram (Rosenberg 2000, Born et al.
2012) for the obtention of a directional approach to the global test.</p>
    

    <pre class="usage"><span class='fu'>eco.malecot</span>(<span class='no'>eco</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"global"</span>, <span class='st'>"local"</span>), <span class='kw'>kinmatrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>int</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>smin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>smax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nclass</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kmax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>seqvec</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"knearest"</span>, <span class='st'>"radialdist"</span>),
  <span class='kw'>cubic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>testclass.b</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>testmantel.b</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>jackknife</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>cummulative</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>normLocal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>,
  <span class='kw'>test</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"permutation"</span>, <span class='st'>"bootstrap"</span>), <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"auto"</span>, <span class='st'>"two.sided"</span>,
  <span class='st'>"greater"</span>, <span class='st'>"less"</span>), <span class='kw'>sequential</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>conditional</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"AUTO"</span>, <span class='st'>"TRUE"</span>,
  <span class='st'>"FALSE"</span>), <span class='kw'>bin</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sturges"</span>, <span class='st'>"FD"</span>), <span class='kw'>row.sd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"holm"</span>,
  <span class='kw'>latlon</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>angle</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eco</th>
      <td><p>Object of class ecogen.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Analysis method: "global" or "local".</p></td>
    </tr>
    <tr>
      <th>kinmatrix</th>
      <td><p>Alternative kinship matrix. The program computes
the Loiselle's kinship matrix (codominant data) with the genetic information
of the ecogen object if kinmatrix = NULL (Defaul option).</p></td>
    </tr>
    <tr>
      <th>int</th>
      <td><p>Distance interval in the units of XY.</p></td>
    </tr>
    <tr>
      <th>smin</th>
      <td><p>Minimum class distance in the units of XY.</p></td>
    </tr>
    <tr>
      <th>smax</th>
      <td><p>Maximum class distance in the units of XY.</p></td>
    </tr>
    <tr>
      <th>nclass</th>
      <td><p>Number of classes.</p></td>
    </tr>
    <tr>
      <th>kmax</th>
      <td><p>Number of nearest-neighbors for local analysis.</p></td>
    </tr>
    <tr>
      <th>seqvec</th>
      <td><p>Vector with breaks in the units of XY.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>Number of individuals per class.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Weight mode for local analyis: "knearest" for nearest neigbors,
"radialdist" for radial distances. Default is knearest.</p></td>
    </tr>
    <tr>
      <th>cubic</th>
      <td><p>Should be performed a cubic interpolation (res~ ln(dij)) 
with the regression residuals (res)  of (kinship)ij ~ ln(dij) ? Defalut TRUE.</p></td>
    </tr>
    <tr>
      <th>testclass.b</th>
      <td><p>Should be performed a permutation test in each individual class? Defalut TRUE.</p></td>
    </tr>
    <tr>
      <th>testmantel.b</th>
      <td><p>Should be performed a Mantel test for testing the slope (b)? Defalut TRUE.</p></td>
    </tr>
    <tr>
      <th>jackknife</th>
      <td><p>Should be performed jackknife in each individual class for computing
the standard deviation (SD) of the coancestry (class) values? Defalut TRUE.</p></td>
    </tr>
    <tr>
      <th>cummulative</th>
      <td><p>Should be construced a cummulative correlogram?.</p></td>
    </tr>
    <tr>
      <th>normLocal</th>
      <td><p>Normalize the local kinship values ([local_kinship-mean]/sd)? Default TRUE</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of Monte-Carlo simulations.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>If test = "bootstrap", the program generates a bootstrap 
resampling and the associated confidence intervals of the null hypothesis.
 If test = "permutation" (default) a permutation test is made and the P-values 
 are computed.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>The alternative hypothesis. If "auto" is selected (default) the
program determines the alternative hypothesis.
Other options are: "two.sided", "greater" and "less".</p></td>
    </tr>
    <tr>
      <th>sequential</th>
      <td><p>Should be performed a Holm-Bonberroni (Legendre and Legendre, 2012) 
adjustment of P-values for global analysis? Defalult TRUE.</p></td>
    </tr>
    <tr>
      <th>conditional</th>
      <td><p>Logical. Should be used a conditional randomization? (Anselin 1998, Sokal and Thomson 2006). The option "auto"
sets conditional = TRUE for LISA methods and G, as suggested by Sokal (2008).</p></td>
    </tr>
    <tr>
      <th>bin</th>
      <td><p>Rule for constructing intervals when a partition parameter (int, 
nclass or size) is not given. Default is Sturge's rule (Sturges, 1926). Other
option is Freedman-Diaconis method (Freedman and Diaconis, 1981).</p></td>
    </tr>
    <tr>
      <th>row.sd</th>
      <td><p>Logical. Should be row standardized the matrix? Default FALSE 
(binary weights).</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>P-values correction method for multiple tests 
passed to <code><a href='http://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code>. Defalut is "holm".</p></td>
    </tr>
    <tr>
      <th>latlon</th>
      <td><p>Are the coordinates in decimal degrees format? Defalut FALSE. If TRUE,
the coordinates must be in a matrix/data frame with the longitude in the first
column and latitude in the second. The position is projected onto a plane in
meters with the function <code><a href='http://www.rdocumentation.org/packages/SoDA/topics/geoXY'>geoXY</a></code>.</p></td>
    </tr>
    <tr>
      <th>angle</th>
      <td><p>direction for computation of bearing correlogram (angle between 0 and 180).
Default NULL (omnidirectional).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For the global analysis, the program returns an object of class "eco.IBD" 
with the following slots:</p>
<p>&gt; OUT analysis output.</p>

<p>In the permutation test case contains: 
- d.mean: mean class distance;
- d.log: mean logarithm of the class distance;
- obs, exp, alter, p.val: observed, and expected value of the statistic
under randomization, alternative, P value;
- mean.jack, sd.jack, Jack.CI.inf, Jack.CI.sup: jackknifed mean and SD,
and confidence intervals for the statistic;
- null.lwr, nul.uppr: lower and upper bound of the jackknife
 confidence interval for the statistic;
- cardinal: number of individuals in each class;</p>

<p>In the bootstrap test case contains: 
- d.mean: mean class distance;
- d.log: mean logarithm of the class distance;
- obs: observed value of the statistic;
- mean.jack, sd.jack, Jack.CI.inf, Jack.CI.sup: jackknifed mean and SD,
and confidence intervals for the statistic;
- null.lwr, nul.uppr: lower and upper bound of the jackknife
 confidence interval for the statistic;
- cardinal: number of individuals in each class;</p>
<p>&gt; GLOBALTEST Oden's (1984) global test of significance for the correlogram.
The test consists in checking if the most significant kinship coefficent is 
significant at a Bonferroni- corrected significance level of alpha' = alpha/k, where
k is the number of distance classes of the correlogram; alpha is set to 0.05.
The program return the values: "SIGNIFICANT" or "NOT-SIGNIFICANT"</p>
<p>&gt; IN analysis input data</p>
<p>&gt; SP Sp statistic results</p>

<p>It contains:</p>
<p>- the regression model;
- information about the distance interval used 
for the regression (restricted);
-  slope (bhat) information (bhat = estimate, SD= bhat jacknife SD, theta =  bhat jackknife mean, 
CI 5% and 95% = 95% confidence interval for bhat);
-  X-intercept = dij intercept (in the original units) for the line with slope "bhat", 
F1 = first class statistic value, and  F1 5% and 95% = confidence interval
for the first class statistic;
- mantel.obs.b = observed value of the Mantel test between
kinship(Fij) and ln(dij); mantel.pval.b = Mantel test P value;
- sp = Sp statistics (sp = Sp observed value, 
CI 5% and 95% = 95% confidence interval 
for Sp);
- cubic_model = cubic model for (kinship)ij ~ ln(dij) r
esiduals vs ln(dij);</p>
<p>&gt; BEAKS breaks</p>
<p>&gt; CARDINAL number of elements in each class</p>
<p>&gt; NAMES variables names</p>
<p>&gt; METHOD analysis method</p>
<p>&gt; DISTMETHOD method used in the construction of breaks</p>
<p>&gt; TEST test method used (bootstrap, permutation)</p>
<p>&gt; NSIM number of simulations</p>
<p>&gt; PADJUST P-values adjust method for permutation tests</p>
<p>------</p>
<p>For the local analysis, the program returns an object of class "eco.lsa" 
with the following slots:</p>
<p>&gt; OUT results</p>

<p>&gt; In the permutation test case contains:</p>
<p>- d.mean: mean class distance
- obs, exp, alter, p.val: observed, and expected value of the statistic
under randomization, alternative, P value;
- null.lwr, nul.uppr: lower and upper bound of the jackknife
 confidence interval for the statistic;
- cardinal: number of individuals in each class;</p>

<p>&gt; In the bootstrap test case contains: 
- d.mean: mean class distance;
- obs: observed value of the statistic;
- null.lwr, nul.uppr: lower and upper bound of the jackknife;
 confidence interval for the statistic;
- cardinal: number of individuals in each class;</p>
<p>&gt; METHOD method (coefficent) used in the analysis</p>
<p>&gt; TEST test method used (bootstrap, permutation)</p>
<p>&gt; NSIM number of simulations</p>
<p>&gt; PADJUST P-values adjust method for permutation tests</p>
<p>&gt; COND conditional randomization (logical)</p>
<p>&gt; XY input coordinates</p>
<p><strong>ACCESS TO THE SLOTS</strong>
The content of the slots can be accessed 
with the corresponding accessors, using
the generic notation of EcoGenetics 
(&lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;name of the object&gt;).
See help("EcoGenetics accessors") and the Examples
section below.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The GLOBAL ANALYSIS mode, computes a multilocus correlogram, with a detailed
summary (see the content of the slot OUT  in the "return" section). 
It also computes (see details about the slot SP in the "return" section):
- the slope of the kinship individual values vs the logarithm of the distance, (kinship)ij ~ ln(dij), with a jackknife confidence
interval 
- a Mantel test for testing the association between  (kinship)ij
and ln(dij) 
- The Sp statistic (Vekemans and Hardy, 2004) with confidence intervals
- A cubic interpolation of (kinship)ij ~ ln(dij) residuals vs ln(dij)</p>
<p>A directional approach is based in bearing analysis method. This compute the 
directional correlogram using the method of Rosenberg (2000). The 
slope is computed for the logarithm of D' (Born et al 2012), where D' is the distance matrix
between individuals weighted by cos(alpha - B)^2, being alpha the angle
between individuals and B the desired direction angle, with B = 0
 the positive x axis, B = 0 the positive y axis, and B = 180 the negative x axis.</p>
    <p>The LOCAL ANALYSIS mode, computes a local kinship estimate, based in a weighted 
mean (for each individual). The signification of each local statistic
is computed using a permutation test, as in eco.lsa (see ?"eco.lsa"). 
Default option do not adjust the individual P values 
for multiple corrections.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Born C., P. le Roux, C. Spohr, M. McGeoch, B. Van Vuuren. 2012.
Plant dispersal in the sub-Antarctic inferred from anisotropic genetic structure.
Molecular Ecology 21: 184-194.</p>
<p>Double M., R. Peakall, N. Beck, and Y. Cockburn. 2005. 
Dispersal, philopatry, and infidelity: dissecting 
local genetic structure in superb fairy-wrens (Malurs cyaneus). 
Evolution 59: 625-635.</p>
<p>Kalisz S., J. Nason, F.M. Handazawa, and S. Tonsor. 2001. 
Spatial population genetic structure in Trillium grandiflorum: 
the roles of dispersal, mating, history, and selection. 
Evolution 55: 1560-1568.</p>
<p>Loiselle B., V. Sork, J. Nason, and C. Graham. 1995. 
Spatial genetic structure of a tropical understory shrub, 
Psychotria officinalis (Rubiaceae). 
American Journal of Botany 1420-1425.</p>
<p>Oden, N., 1984. Assessing the significance of a spatial correlogram. 
Geographical Analysis, 16: 1-16.</p>
<p>Rosenberg, M. 2000. The bearing correlogram: a new method 
of analyzing directional spatial autocorrelation. 
Geographical Analysis, 32: 267-278.</p>
<p>Vekemans, X., and O. Hardy. 2004. New insights from fine-scale 
spatial genetic structure analyses in plant populations. 
Molecular Ecology, 13: 921-935.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div># NOT RUN {
data(eco.test)

# ---global analysis---

globaltest <- eco.malecot(eco=eco, method = "global", smax=10,
                         size=1000)
eco.plotCorrelog(globaltest)    # Significant mean class coancestry classes at   
                    # individual level (alpha = 0.05, 
                    # out of the red area), 
                    # and family-wise P corrected values (red-blue
                    # points, indicated in the legend)

# ecoslot.SP(globaltest) contains:
# - the slope (bhat) and values with confidence intervals
#  of the regression reg = kinship ~ ln(distance_between_individuals)
#- A Mantel test result for assesing the relation between
#  between  kinship and ln(distance_between_individuals)
#- A cubic interpolation between the residuals of reg and 
#  ln(distance_between_individuals)
#- the sp statistic and its confidence interval

# ecoslot.OUT(globaltest) contains:
# - In permutation case, the values of mean and log-mean distance    
#   classes; observed class value; expected + alternative + P value,
#   the bootstrap null confidence intervals and 
#   jackknife statistics (jackknifed mean, jackknifed SD, and
#                         CI for the class statistic)

# - In bootstrap case, the values of mean and log-mean distance
#   classes;the bootstrap null confidence intervals and 
#   jackknife statistics (jackknifed mean, jackknifed SD, and
#                         CI for the class statistic)


A directional approach based in bearing correlograms, 30 degrees
globaltest_30 <- eco.malecot(eco=eco, method = "global", smax=10,
                         size=1000, angle = 30)
eco.plotCorrelog(globaltest, angle = 30) 

#----------------------------------------------------------#
# ---local analysis---


(using the spatial weights). 

# ---local analysis with k nearest neighbors---



localktest <- eco.malecot(eco=eco, method = "local",
                         type = "knearest", kmax = 5, 
                         adjust = "none")
eco.plotLocal(localktest)


# ---local analysis with radial distance---

localdtest <- eco.malecot(eco=eco, method = "local",
                        type = "radialdist", smax = 3, 
                        adjust = "none")
                        
eco.plotLocal(localdtest)                    # rankplot graphic (see ?"eco.rankplot")

                                         # Significant values
                                         # in blue-red scale, 
                                         # non significant 
                                         # values in yellow

eco.plotLocal(localktest, significant = FALSE)    # significant and non
                                              # signficant values
                                              # in blue-red scale

# The slot OUT of localktest (ecoslot.OUT(localktest)) and localdtest 
# (ecoslot.OUT(localdtest)) contains:
# - the mean distance per individual, observed value of the
#   statistic, expected + alternative + P value + null hypotesis
#   confidence intervals,  or boostrap confidence intervals in 
#   permutation or bootstrap cases, respectively.
# }
<div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Leandro Roser <a href='mailto:leandroroser@ege.fcen.uba.ar'>leandroroser@ege.fcen.uba.ar</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Leandro Roser, Juan Vilardi, Beatriz Saidman, Laura Ferreyra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
