<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Global spatial analysis — eco.gsa • EcoGenetics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EcoGenetics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cran/EcoGenetics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Global spatial analysis</h1>
    </div>

    
    <p>Univariate and multivariable global spatial analysis.This program computes Moran's I, Geary's C,  Bivariate Moran's I or
Join-count statistics with P-values.</p>
<p>The program allows the analysis of a single variable or multiple variables. 
in this latter last case, the variables must be in columns and the individuals in rows.</p>
<p>In join-count analysis, a ploidy argument must be supplied. The data is then ordered with the 
function <code><a href='aue.sort.html'>aue.sort</a></code>. This step is required for the analysis of
genotypic data. An individual with the alleles A and B, coded as AB, is identical 
to other coded as BA. The order step ensures the AB and BA 
will be considered the same genotype. For the analysis of frequencies of single alleles, the input 
is count data (ploidy times the frequency, as provided by the slot
A of an ecogen object: the count data A' can be obtained as A' &lt;- ploidy * A),
using the function with the arguments ploidy = 1.</p>
    

    <pre class="usage"><span class='fu'>eco.gsa</span>(<span class='no'>Z</span>, <span class='no'>con</span>, <span class='kw'>Y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"I"</span>, <span class='st'>"C"</span>, <span class='st'>"CC"</span>, <span class='st'>"JC"</span>), <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>,
  <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"auto"</span>, <span class='st'>"two.sided"</span>, <span class='st'>"greater"</span>, <span class='st'>"less"</span>), <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>, <span class='kw'>plotit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Z</th>
      <td><p>Vector with a variable, or matrix/data frame with variables in columns.</p></td>
    </tr>
    <tr>
      <th>con</th>
      <td><p>An object of class eco.weight obtained with the function <code><a href='eco.weight.html'>eco.weight</a></code>,
a listw object or a matrix, giving the spatial weights for the analysis. If "con" is a matrix,
an attribute "xy" including the projected coordinates is required.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>Vector with the second variable for Moran's Ixy.
If Z has multiple variables, the program will compute the coefficent 
for each with Y.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method of analysis: "I" for Moran's I, "C" for Geary's C, "CC" for
the Bivariate Moran's or "JC" for Join-count.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of Monte-Carlo simulations.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>The alternative hypothesis. If "auto" is selected (default) the
program determines the alternative hypothesis.
Other options are: "two.sided", "greater" and "less".</p></td>
    </tr>
    <tr>
      <th>ploidy</th>
      <td><p>For join count analysis: number of elements for the values of the vector passed, given value: for example,
if ploidy=1, "13" and "31" are considered a same level ("31" is sorted by the program as "13"); 
if ploidy = 1, "13" and "31" represent two different levels.</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>Correction method of P-values for multiple tests, 
passed to <code><a href='http://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code>. Defalut is "fdr".</p></td>
    </tr>
    <tr>
      <th>plotit</th>
      <td><p>should be generated a plot for univariate results?</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The program returns an object of class "eco.gsa" with the following slots:</p>
<p>&gt; METHOD method used in the analysis</p>
<p>&gt; OBS observed value when a single variable is tested</p>
<p>&gt; EXP expected value when a single variable is tested</p>
<p>&gt; PVAL P-value when a single variable is tested</p>
<p>&gt; ALTER alternative hypotesis when a single variable is tested</p>
<p>&gt; NSIM number of simulations</p>
<p>&gt; MULTI table with observed and expected values, P-values and alternative
hypoteses when multiple variables are tested</p>
<p><strong>ACCESS TO THE SLOTS</strong>
The content of the slots can be accessed 
with the corresponding accessors, using
the generic notation of EcoGenetics 
(&lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;name of the object&gt;).
See help("EcoGenetics accessors") and the Examples
section below.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Geary R. 1954. The contiguity ratio and statistical mapping. 
The incorporated statistician, 115-146.</p>
<p>Moran P. 1950. Notes on continuous stochastic phenomena. Biometrika, 17-23.</p>
<p>Reich R., R. Czaplewski and W. Bechtold. 1994. 
Spatial cross-correlation of undisturbed, natural shortleaf pine stands 
in northern Georgia. Environmental and Ecological Statistics, 1: 201-217.</p>
<p>Sokal R. and N. Oden 1978. Spatial autocorrelation in biology: 
1. Methodology. Biological journal of the Linnean Society, 10: 199-228.</p>
<p>Sokal R. and N. Oden. 1978. Spatial autocorrelation in biology. 
2. Some biological implications and four applications of evolutionary and 
ecological interest. Biological Journal of the Linnean Society, 10: 229-49.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>data</span>(<span class='no'>eco.test</span>)

<span class='co'># Moran's I </span>

<span class='co'>### one test</span>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.weight.html'>eco.weight</a></span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"circle"</span>, <span class='kw'>d1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>global</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]][, <span class='fl'>1</span>], <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"I"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>200</span>)
<span class='no'>global</span>

<span class='fu'>require</span>(<span class='no'>adegenet</span>)
<span class='no'>con2</span><span class='kw'>&lt;-</span><span class='fu'><a href='http://www.rdocumentation.org/packages/adegenet/topics/chooseCN'>chooseCN</a></span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>result.type</span> <span class='kw'>=</span> <span class='st'>"listw"</span>, <span class='kw'>plot.nb</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>global</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]][, <span class='fl'>1</span>], <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con2</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"I"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>200</span>)
<span class='no'>global</span>

<span class='co'>#-----------------------</span>
<span class='co'># ACCESSORS USE EXAMPLE</span>
<span class='co'>#-----------------------</span>

<span class='co'># the slots are accesed with the generic format </span>
<span class='co'># (ecoslot. + name of the slot + name of the object). </span>
<span class='co'># See help("EcoGenetics accessors")</span>

<span class='co'># observed value</span>
<span class='fu'><a href='EcoGenetics-accessors.html'>ecoslot.OBS</a></span>(<span class='no'>global</span>)

<span class='co'># p-value</span>
<span class='fu'><a href='EcoGenetics-accessors.html'>ecoslot.PVAL</a></span>(<span class='no'>global</span>)

<span class='co'>#----------------</span>
<span class='co'># multiple tests</span>
<span class='co'>#----------------</span>
<span class='fu'>data</span>(<span class='no'>eco3</span>)
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.weight.html'>eco.weight</a></span>(<span class='no'>eco3</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"circle"</span>, <span class='kw'>d1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fl'>500</span>)
<span class='no'>global</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco3</span><span class='kw'>[[</span><span class='st'>"P"</span>]], <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"I"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>200</span>)
<span class='no'>global</span>
<span class='co'># Plot method for multivariable eco.gsa objects:</span>
<span class='fu'><a href='eco.plotGlobal.html'>eco.plotGlobal</a></span>(<span class='no'>global</span>)

<span class='co'>#--------------------------------</span>
<span class='co'># accessor use in multiple tests</span>
<span class='co'>#--------------------------------</span>

<span class='fu'><a href='EcoGenetics-accessors.html'>ecoslot.MULTI</a></span>(<span class='no'>global</span>)


<span class='co'>#----------------------------------------</span>

<span class='co'># Gearys's C </span>

<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.weight.html'>eco.weight</a></span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"circle"</span>, <span class='kw'>d1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>global.C</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]][, <span class='fl'>1</span>], <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"C"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>200</span>)
<span class='no'>global.C</span>

<span class='co'>#----------------------------------------</span>

<span class='co'># Bivariate's Moran's Ixy</span>

<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eco.weight.html'>eco.weight</a></span>(<span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"XY"</span>]], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"circle"</span>, <span class='kw'>d1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>d2</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>global.Ixy</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"P"</span>]][, <span class='fl'>1</span>], <span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"E"</span>]][, <span class='fl'>1</span>],
<span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"CC"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>200</span>)
<span class='no'>global.Ixy</span>

<span class='co'>#----------------------------------------</span>

<span class='co'># Join-count</span>

<span class='co'>## using the allelic frequency matrix of an ecogen object. </span>
<span class='co'>## The data is diploid. Frequencies are transformed into counts</span>
<span class='co'>## as ploidy * frequency_matrix:</span>

<span class='no'>Z</span> <span class='kw'>=</span> <span class='fl'>2</span>* <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"A"</span>]]


<span class='no'>jc</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='no'>Z</span>[, <span class='fl'>1</span>], <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"JC"</span>)
<span class='fu'><a href='eco.plotGlobal.html'>eco.plotGlobal</a></span>(<span class='no'>jc</span>)

<span class='co'># multiple tests</span>
<span class='co'># using the first ten alleles of the matrix</span>
<span class='no'>global.JC</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='no'>Z</span>[, <span class='fl'>1</span>:<span class='fl'>10</span>], <span class='kw'>ncod</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"JC"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>)
<span class='no'>global.JC</span>
<span class='co'># plot method for multivariable join-count</span>
<span class='fu'><a href='eco.plotGlobal.html'>eco.plotGlobal</a></span>(<span class='no'>global.JC</span>)

<span class='co'># counting joins between genotypes in the first locus the G matrix:</span>
<span class='no'>global.JC</span> <span class='kw'>&lt;-</span> <span class='fu'>eco.gsa</span>(<span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>eco</span><span class='kw'>[[</span><span class='st'>"G"</span>]][, <span class='fl'>1</span>], <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>con</span> <span class='kw'>=</span> <span class='no'>con</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"JC"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>99</span>)
<span class='no'>global.JC</span>
<span class='fu'><a href='eco.plotGlobal.html'>eco.plotGlobal</a></span>(<span class='no'>global.JC</span>)

<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Leandro Roser <a href='mailto:learoser@gmail.com'>learoser@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Leandro Roser, Juan Vilardi, Beatriz Saidman, Laura Ferreyra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
